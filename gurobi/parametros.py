from gurobipy import *

import numpy as np

#############
# CONJUNTOS #
#############


# PROTOCOLOS

P = [k for k in range(1,4)] 
# 3 protocolos - 1, 2, 3

Largo_P = [7, 5, 7] 
# Duracion de cada protocolo en sesiones

# SESIONES

# Sesiones del protocolo p

S = {} 

for i in P:

  S.update({i:[k for k in range(1,Largo_P[int(i)-1] + 1)]})

# MÓDULOS - maestro usaba 53

M = [k for k in range(1,41)] 
# 40 bloques - 1, 2, ..., 40 
# 10 horas de trabajo, cada modulo consiste en 15 min

#Días

T = [int(k) for k in range(1, 42)]

##############
# PARÁMETROS #
##############


# Variable GAMMA 

γ = 0.95

# Costos por protocolo
#estimados

Costos = [1000000,1000000,1000000]

CD = dict(zip(P,Costos)) 
# Asocia los costos cada protocolo con su costo de derivación

# Costo bloque regular

CR = 1000 

# Costo bloque extra

CE = 2000

CM = (CE - CR)/4 # Costo marginal por bloque extra de atención 


# Cantidad de modulos de la sesion s del tratamiento p

M_sp = {} 

for i in P:

    M_sp.update({i:{}})

    for j in S[i]:

        M_sp[i].update({j:5})


# Bloques regulares efectivos
# Jornada de 8 horas

BR = 32 

# Bloques extra efectivos
# 1,5 horas

BE = 8 

# Maestro

BR2 = 40 # Bloques regulares nominales

BE2 = [k for k in range(1, 13)] # Bloques extra nominales

# Variable  que indica numero de pacientes con protocolo p que llegan en la semana

q = {1: 10, 2: 10, 3: 10 }



#tiempo entre la sesion s y su primera sesion
#escrita como diccionario para que no hayan errores en los indices
K_ps = \
{1: {1: 0, 2: 5, 3: 10, 4: 11, 5: 12, 6: 13, 7: 14}, \
2: {1: 0, 2: 3, 3: 7, 4: 9, 5: 11}, \
3: {1: 0, 2: 4, 3: 10, 4: 15, 5: 20, 6: 23, 7: 26}}


##############
# PARÁMETROS #
##############

# Variable GAMMA

# Número de enfermeras

NE = 5

# Número de sillas

NS = 5

# Lp: maximo de días que puede esperar un paciente del protocolo p para empezar su tratamiento

Lp = {1: 15, 2: 15, 3: 15}

#obtenidos a partir de la simulacion
#estimados a mano
#si uso estas esperanzas la fase 1 no logra encontrar una base inicial factible
E_pst = \
{1: {1: {1: 4, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 4, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 2, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0,  26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 4, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 4, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 2, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 3, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 4, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 4, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 2, 24: 0, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
4: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 4, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 4, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 2, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
5: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 4, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 4, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 2, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0},
6: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 4, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 4, 21: 0, 22: 0, 23: 0, 24: 0, 25:0, 26: 2, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
7: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 4, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 4, 22: 0, 23: 0, 24: 0, 25:0, 26: 0, 27: 2, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}}, \

2: {1: {1: 2, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 5, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 3, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0,  26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
2: {1: 0, 2: 0, 3: 0, 4: 2, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 5, 11: 0, 12: 0, 13: 3, 14: 0, 15: 0, 16: 3, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 3, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 2, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 5, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 3, 21: 0, 22: 0, 23: 0, 24: 0, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
4: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 2, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 5, 17: 0, 18: 4, 19: 0, 20: 0, 21: 0, 22: 3, 23: 0, 24: 0, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
5: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 2, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 5, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 3, 25: 0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}}, \

3: {1: {1: 5, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 3, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 2, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0,  26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
2: {1: 0, 2: 0, 3: 0, 4: 0, 5: 5, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 3, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 2, 18: 2, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 3, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
3: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 5, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 3, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 2, 24: 0, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
4: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 5, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 3, 23: 0, 24: 0, 25:0, 26: 0, 27: 0, 28: 2, 29: 0, 30: 0, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
5: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 5, 17: 0, 18: 0, 19: 0, 20: 0, 21: 5, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 0, 28: 3, 29: 0, 30: 0, 31: 0, 32: 0, 33: 2, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0},
6: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 4, 19: 0, 20: 0, 21: 5, 22: 0, 23: 0, 24: 5, 25:0, 26: 0, 27: 0, 28: 0, 29: 0, 30: 3, 31: 0, 32: 0, 33: 0, 34: 0, 35: 0, 36: 2, 37: 0, 38: 0, 39: 0, 40: 0, 41: 0, 42: 0}, \
7: {1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 0, 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 21: 0, 22: 0, 23: 0, 24: 0, 25: 0, 26: 0, 27: 5, 28: 0, 29: 0, 30: 0, 31: 0, 32: 0, 33: 3, 34: 0, 35: 0, 36: 0, 37: 0, 38: 0, 39: 2, 40: 0, 41: 0, 42: 0}}}